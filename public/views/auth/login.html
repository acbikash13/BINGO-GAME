<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Page</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Stylish&display=swap" rel="stylesheet">
    <style>
      html, body {
        height: 100%;
        margin: 0;
        font-family: Arial, Helvetica, sans-serif;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      form {
        width: 400px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 15px;
      }
      @media screen and (max-width:450px ) {
        form {
          max-width: 350px;
        }
        .g-signin2 {
          max-width: 200px !important;
          font-size: 11px !important;
        }
      }
      input[type="text"], input[type="password"], textarea {
        border-radius: 10px;
        box-shadow: 0px 0px 40px 0px rgb(108, 122, 132);
        height: 60px;
      } 
      .login-button, #signUpButton, button {
        font-size: 15px;
        font-family: Georgia, 'Times New Roman', Times, serif;
        border-radius: 10px;
        box-shadow: 0px 0px 40px 0px rgb(108, 122, 132);
      }
      .login-button {
        width: 100%;
      }
      .horizontalLine {
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      hr {
        color: white;
        width: 40%;
        height: 1px;
        background-color: white;
      }
      p {
        font-size: 16px;
      }
      .otherOptionsForLoggin {
        width: 100%;
        display: flex;
        justify-content: space-around;
      }
      img {
        border-radius: 50px;
      }
      .main-div {
        height: 90vh;
        border-radius: 20px;
        box-shadow: rgba(0, 0, 0, 0.4) 0px 30px 90px;
      }
      hr {
        background-color: rgb(20, 175, 175);
      }
      .welcome {
        font-family: "Stylish", serif;
        font-style: normal;
      }
    
    </style>
</head>
<body class="container row">
  <div class="bg-light row  main-div">
    <img class="col-12 col-md-7 col-sm-12 my-3"  src="../../assests/homepage3.png" alt="Homepage Image">
    <div class="col-12 col-md-5 col-sm-12 bg-light rounded shadow-lg d-flex justify-contents-center">
      <form id="login-form" class="login mx-auto my-auto">
        <p class="text-info display-4 welcome">Welcome to the BINGO Game! <br> Please Sign in!</p>
        <input id="email" type="text" placeholder="Email or username" class="form-control mt-3" name="email">
        <input id="password" type="password" placeholder="Password" class="form-control mt-3" name="password">
        <button type="submit" class="btn login-button btn-info p-2 mt-3">Login</button>
        <div class="horizontalLine">
          <hr>
          <p class="text-light text-center my-auto text-dark">Or</p>
          <hr>
        </div>
        <div class="otherOptionsForLoggin text-center">
          <button type="button" class="btn bg-light text-info p-2 m-4" id="signUpButton">Sign Up</button>
          <button type="button" onclick="loginWithGoogle()" class="btn bg-light text-info m-4" id="signin-with-google">
            <svg xmlns="http://www.w3.org/2000/svg"  width="30" height="30" viewBox="0 0 64 64">
              <stop offset="0" stop-color="#f4e9c3"></stop><stop offset=".219" stop-color="#f8eecd"></stop><stop offset=".644" stop-color="#fdf4dc"></stop><stop offset="1" stop-color="#fff6e1"></stop></radialGradient><path fill="url(#95yY7w43Oj6n2vH63j6HJa_fQDK2sCN4Eh1_gr1)" d="M63.97,30.06C63.68,32.92,61.11,35,58.24,35H53c-1.22,0-2.18,1.08-1.97,2.34	c0.16,0.98,1.08,1.66,2.08,1.66h3.39c2.63,0,4.75,2.28,4.48,4.96C60.74,46.3,58.64,48,56.29,48H51c-1.22,0-2.18,1.08-1.97,2.34	c0.16,0.98,1.08,1.66,2.08,1.66h3.39c1.24,0,2.37,0.5,3.18,1.32C58.5,54.13,59,55.26,59,56.5c0,2.49-2.01,4.5-4.5,4.5h-44	c-1.52,0-2.9-0.62-3.89-1.61C5.62,58.4,5,57.02,5,55.5c0-3.04,2.46-5.5,5.5-5.5H14c1.22,0,2.18-1.08,1.97-2.34	C15.81,46.68,14.89,46,13.89,46H5.5c-2.63,0-4.75-2.28-4.48-4.96C1.26,38.7,3.36,37,5.71,37H13c1.71,0,3.09-1.43,3-3.16	C15.91,32.22,14.45,31,12.83,31H4.5c-2.63,0-4.75-2.28-4.48-4.96C0.26,23.7,2.37,22,4.71,22h9.79c1.24,0,2.37-0.5,3.18-1.32	C18.5,19.87,19,18.74,19,17.5c0-2.49-2.01-4.5-4.5-4.5h-6c-1.52,0-2.9-0.62-3.89-1.61S3,9.02,3,7.5C3,4.46,5.46,2,8.5,2h48	c3.21,0,5.8,2.79,5.47,6.06C61.68,10.92,60.11,13,57.24,13H55.5c-3.04,0-5.5,2.46-5.5,5.5c0,1.52,0.62,2.9,1.61,3.89	C52.6,23.38,53.98,24,55.5,24h3C61.71,24,64.3,26.79,63.97,30.06z"></path><linearGradient id="95yY7w43Oj6n2vH63j6HJb_fQDK2sCN4Eh1_gr2" x1="29.401" x2="29.401" y1="4.064" y2="106.734" gradientTransform="matrix(1 0 0 -1 0 66)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#ff5840"></stop><stop offset=".007" stop-color="#ff5840"></stop><stop offset=".989" stop-color="#fa528c"></stop><stop offset="1" stop-color="#fa528c"></stop></linearGradient><path fill="url(#95yY7w43Oj6n2vH63j6HJb_fQDK2sCN4Eh1_gr2)" d="M47.46,15.5l-1.37,1.48c-1.34,1.44-3.5,1.67-5.15,0.6c-2.71-1.75-6.43-3.13-11-2.37	c-4.94,0.83-9.17,3.85-11.64,7.97l-8.03-6.08C14.99,9.82,23.2,5,32.5,5c5,0,9.94,1.56,14.27,4.46	C48.81,10.83,49.13,13.71,47.46,15.5z"></path><linearGradient id="95yY7w43Oj6n2vH63j6HJc_fQDK2sCN4Eh1_gr3" x1="12.148" x2="12.148" y1=".872" y2="47.812" gradientTransform="matrix(1 0 0 -1 0 66)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#feaa53"></stop><stop offset=".612" stop-color="#ffcd49"></stop><stop offset="1" stop-color="#ffde44"></stop></linearGradient><path fill="url(#95yY7w43Oj6n2vH63j6HJc_fQDK2sCN4Eh1_gr3)" d="M16.01,30.91c-0.09,2.47,0.37,4.83,1.27,6.96l-8.21,6.05c-1.35-2.51-2.3-5.28-2.75-8.22	c-1.06-6.88,0.54-13.38,3.95-18.6l8.03,6.08C16.93,25.47,16.1,28.11,16.01,30.91z"></path><linearGradient id="95yY7w43Oj6n2vH63j6HJd_fQDK2sCN4Eh1_gr4" x1="29.76" x2="29.76" y1="32.149" y2="-6.939" gradientTransform="matrix(1 0 0 -1 0 66)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#42d778"></stop><stop offset=".428" stop-color="#3dca76"></stop><stop offset="1" stop-color="#34b171"></stop></linearGradient><path fill="url(#95yY7w43Oj6n2vH63j6HJd_fQDK2sCN4Eh1_gr4)" d="M50.45,51.28c-4.55,4.07-10.61,6.57-17.36,6.71C22.91,58.2,13.66,52.53,9.07,43.92l8.21-6.05	C19.78,43.81,25.67,48,32.5,48c3.94,0,7.52-1.28,10.33-3.44L50.45,51.28z"></path><linearGradient id="95yY7w43Oj6n2vH63j6HJe_fQDK2sCN4Eh1_gr5" x1="46" x2="46" y1="3.638" y2="35.593" gradientTransform="matrix(1 0 0 -1 0 66)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#155cde"></stop><stop offset=".278" stop-color="#1f7fe5"></stop><stop offset=".569" stop-color="#279ceb"></stop><stop offset=".82" stop-color="#2cafef"></stop><stop offset="1" stop-color="#2eb5f0"></stop></linearGradient><path fill="url(#95yY7w43Oj6n2vH63j6HJe_fQDK2sCN4Eh1_gr5)" d="M59,31.97c0.01,7.73-3.26,14.58-8.55,19.31l-7.62-6.72c2.1-1.61,3.77-3.71,4.84-6.15	c0.29-0.66-0.2-1.41-0.92-1.41H37c-2.21,0-4-1.79-4-4v-2c0-2.21,1.79-4,4-4h17C56.75,27,59,29.22,59,31.97z"></path>
            </svg>
            Sign In with Google
          </button>
        </div>
        <a class="text-info" href="/contact" target="_blank" style="text-decoration: underline; font-size: 18px;" >Please Contact Us Here!</a>
      </form>
    </div>
  </div>

  <!-- jQuery library -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <!-- Popper JS -->
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
  <!-- Bootstrap JS -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script src="https://unpkg.com/typewriter-effect@latest/dist/core.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.6/axios.min.js"></script>
  <script src="/controller/cookies.js"></script>
  <!-- <script src="../js/script.js"></script> -->
  <script>
    const loginForm = document.getElementById('login-form');
    loginForm.addEventListener("submit", (event) => {
      event.preventDefault();
      const email = loginForm.email.value;
      const password = loginForm.password.value;
      const userData = {
        userName: email,
        password: password
      };
      axios.post('/api/auth/login', userData)
      .then(response => {
        console.log("Response inside res is " + response)
        if (response.status === 200) {
          console.log(response.data.message);
          // Store JWT in cookies
          cookies.set('jwt', response.headers.authorization.replace('Bearer ', ''));
          window.location.href = '/homePage';
        } else {
          // Handle unexpected non-200 statuses
          console.error("Unexpected status:", response.status);
          alert(response.data.message);
        }
      })
      .catch(error => {
        console.log("Error inside catch is " + error)
        // Log the full error response for debugging
        if (error.response) {
          console.log("Error response:", error.response);
          if (error.response.status === 404) {
            alert("User is not registered. Please sign up.");
          } else if (error.response.status === 401) {
            alert("Incorrect password. Please try again.");
          } else {
            alert(error.response.data.message);
          }
        } else {
          console.error("Error:", error);
          alert("Network error or server unreachable.");
        }
      });
    });



    const signUpButton = document.getElementById("signUpButton");
    signUpButton.addEventListener("click", () => {
      window.location.href = '/signup';
    });

    async function loginWithGoogle() {
      try {
        const response = await axios.get('/google/authurl');
        window.location.href = response.data.url;
      } catch (error) {
        console.error('Error fetching auth URL:', error);
      }
    }
  </script>
</body>
</html>
